<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>延迟加载</title>
<style>
*{margin:0;padding:0;}
li{list-style:none;}
.ceshiDiv{margin:10px auto; width:1000px; height:400px; border:1px solid #ccc;}
.imgBox{width:1000px; margin:0 auto 100px; height:600px;}
.imgBox li{width:250px; text-align:center; float:left; margin-bottom:15px;}
.imgBox li img{opacity:0;filter:alpha(opacity=0);}
</style>
<script src="js/jquery-1.4.2.min.js"></script>
<script>
$(function(){
	//addAttrSrc();
	//alert(posOffsetTop($(".ceshiImg").first()))
	
	//alert($(".ceshiImg").eq(0).offset().top);
	//alert($(window).height());
	
});

window.onresize = window.onscroll = function(){
	var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
	var imgArry = $(".ceshiImg");

	imgArry.each(function(i){
		var sysHei = $(window).height() + scrollTop;
		var imgHei = $(".ceshiImg").eq(i).offset().top;
		if(sysHei >= imgHei){
			imgArry.eq(i).attr("src",imgArry.eq(i).attr("_src")).animate({"opacity":1});
		}
	});
}
//当图片进入到可见区域的时候，将图片的_src的地址替换给src即可
//当滚动条进入到图片的可见范围，也就是说图片的顶点位置到达最顶点的位置，也就是需要获取图片元素到最外层顶点元素的距离
//获取屏幕页面可视区域的最低点的位置
//判断这个页面元素的最低点（可视区域 + 滚动距离）是否大于等于这个元素的到顶点的高度
function getId(id){
	return document.getElementById(id);
}
//获取某一个元素到最外层顶点的位置
function posOffsetTop(ele){
	var top = ele.offsetTop;
	var parent = ele.offsetParent;
	
	while(parent!=null){//死循环，不停的向上追溯
		top += parent.offsetTop;
		parent = parent.offsetParent;
	}
	return top;
	
}
</script>
</head>

<body>
<div class="ceshiDiv"></div>
<div class="ceshiDiv"></div>
<div class="ceshiDiv"></div>
<div class="ceshiDiv"></div>
<div class="imgBox">
	<ul>
    	<li>
        	<img class="ceshiImg" _src="img/p1.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p2.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p3.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p4.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p5.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p6.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p7.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p8.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p9.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p10.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p1.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
        <li>
        	<img class="ceshiImg" _src="img/p12.jpg" src="img/wait_load.jpg"/>
            <p>测试延迟加载...</p>
        </li>
    </ul>
</div>
</body>
</html>
